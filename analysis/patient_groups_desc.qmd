---
title: "Group Summaries"
format: html
editor: visual
---

```{r}
#| echo: false
#| warning: false
library(tidyverse)
#library(plyr)
library(tidyr)
library(dplyr)
library(readxl)
library(stringr)
#library(magrittr)
#library(stringi)
library(janitor)
library(Publish)
```

```{r}
#| warning: false
#| echo: false

setwd("/home/ni3853/Documents/quartoproj")
data <- read_csv("data/ImmunoVax_ATCcodes.csv") %>% 
  dplyr::select(1:4,22:41) %>%
  unique()
```

```{r}
#| warning: false
#| echo: false

CTOgroup <- data %>% filter(ptgroup == "CTO") 
```

```{r}
#| warning: false
#| echo: false

IALgroup <- data %>% filter(ptgroup == "IAL") 
```

```{r}
#| warning: false
#| echo: false
```

```{r}
#| warning: false
#| echo: false

```

```{r}
#| warning: false
#| echo: false

HEMgroup <- data %>% filter(ptgroup == "HEM")  %>%
  mutate(alk_agents = case_when(grepl("L01A", atc_codelist)| grepl("L01A", ema_codelist)  ~ 1,
                                !grepl("L01A", atc_codelist)| !grepl("L01A", ema_codelist) ~ 0),
         anti_metab= case_when(grepl("L01B", atc_codelist)| grepl("L01B", ema_codelist)  ~ 1,
                                !grepl("L01B", atc_codelist)| !grepl("L01B", ema_codelist) ~ 0),
         plant_alk = case_when(grepl("L01C", atc_codelist)| grepl("L01C", ema_codelist)  ~ 1,
                                !grepl("L01C", atc_codelist)| !grepl("L01C", ema_codelist) ~ 0),
         cytotox_antib = case_when(grepl("L01D", atc_codelist)| grepl("L01D", ema_codelist)  ~ 1,
                                !grepl("L01D", atc_codelist)| !grepl("L01D", ema_codelist) ~ 0),
          pk_inhib = case_when(grepl("L01E", atc_codelist)|grepl("L01E", ema_codelist) ~ 1,
                              !grepl("L01E", atc_codelist)|!grepl("L01E", ema_codelist)~ 0),
         mono_antib = case_when(grepl("L01F", atc_codelist)| grepl("L01F", ema_codelist)  ~ 1,
                                !grepl("L01F", atc_codelist)| !grepl("L01F", ema_codelist) ~ 0),
          other_antineo = case_when(grepl("L01X", atc_codelist)|grepl("L01X", ema_codelist) ~ 1,
                              !grepl("L01X", atc_codelist)|!grepl("L01X", ema_codelist)~ 0))

univariateTable( ~ mono_antib + pk_inhib + plant_alk +
                  cytotox_antib + pk_inhib + mono_antib + other_antineo,
                data = HEMgroup)
```

```{r}
#| warning: false
#| echo: false

ONMgroup <- data %>% filter(ptgroup == "ONM")  %>%
  mutate(alk_agents = case_when(grepl("L01A", atc_codelist)| grepl("L01A", ema_codelist)  ~ 1,
                                !grepl("L01A", atc_codelist)| !grepl("L01A", ema_codelist) ~ 0),
         anti_metab= case_when(grepl("L01B", atc_codelist)| grepl("L01B", ema_codelist)  ~ 1,
                                !grepl("L01B", atc_codelist)| !grepl("L01B", ema_codelist) ~ 0),
         plant_alk = case_when(grepl("L01C", atc_codelist)| grepl("L01C", ema_codelist)  ~ 1,
                                !grepl("L01C", atc_codelist)| !grepl("L01C", ema_codelist) ~ 0),
         cytotox_antib = case_when(grepl("L01D", atc_codelist)| grepl("L01D", ema_codelist)  ~ 1,
                                !grepl("L01D", atc_codelist)| !grepl("L01D", ema_codelist) ~ 0),
          pk_inhib = case_when(grepl("L01E", atc_codelist)|grepl("L01E", ema_codelist) ~ 1,
                              !grepl("L01E", atc_codelist)|!grepl("L01E", ema_codelist)~ 0),
         mono_antib = case_when(grepl("L01F", atc_codelist)| grepl("L01F", ema_codelist)  ~ 1,
                                !grepl("L01F", atc_codelist)| !grepl("L01F", ema_codelist) ~ 0),
          other_antineo = case_when(grepl("L01X", atc_codelist)|grepl("L01X", ema_codelist) ~ 1,
                              !grepl("L01X", atc_codelist)|!grepl("L01X", ema_codelist)~ 0)
        )
#table(ONMgroup$Disease, ONMgroup$mono_antib)
univariateTable( ~Disease,
                data = ONMgroup)
univariateTable( ~ mono_antib + pk_inhib + plant_alk +
                  cytotox_antib + pk_inhib + mono_antib + other_antineo,
                data = ONMgroup)
```
